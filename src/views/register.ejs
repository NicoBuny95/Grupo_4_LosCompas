<%- include('./partials/head') %>

<body>
    <%- include('./partials/header') %>
    <% if (typeof success !== 'undefined') { %>
        <div class="alert alert-success" id="success-message" role="alert">
          <%= success %>
        </div>
      <% } %>

    <div class="container-form">
        <form action="/user/register" method="POST" id="registration-form" class="registration-form" enctype="multipart/form-data">
            <h1>Registro de Usuarios</h1>
            <div class="form-group">
                <i class="fa-solid fa-user"></i> 
                <input type="text" id="username" name="username" placeholder="" 
                class="<%= locals.errors && errors.name 
                ? 'is-invalid' 
                : null 
                %>" value="<%= locals.oldData ? oldData.username : null %>" >
                <label for="username">Nombre de Usuario</label>
                <div class="error-message" id="error-username"></div>
                <% if (locals.errors && errors.username) { %>
                    <div class= "error-msg"  id="error-user-msg">
                        <%= errors.username.msg %>               
                    </div>
                <% } %>
            </div>
            
            <div class="form-group">
                <i class="fa-solid fa-user"></i> 
                <input type="text" id="firstName" name="firstName" placeholder="" 
                class="<%= locals.errors && errors.name 
                    ? 'is-invalid' 
                    : null 
                    %>" value="<%= locals.oldData ? oldData.firstName : null %>">
                <label for="firstName">Nombre</label>
                <div class="error-message" id="error-firstName"></div> 
                <% if (locals.errors && errors.firstName) { %>
                    <div class= "error-msg" id="error-firstName-msg">
                        <%= errors.firstName.msg %>               
                    </div>
                <% } %>
            </div>
            <div class="form-group">
                <i class="fa-solid fa-user"></i> 
                <input type="text" id="lastName" name="lastName" placeholder="" 
                class="<%= locals.errors && errors.name 
                ? 'is-invalid' 
                : null 
                %>" value="<%= locals.oldData ? oldData.lastName : null %>">
                <label for="lastName">Apellido</label>
                <div class="error-message" id="error-lastName"></div>
                <% if (locals.errors && errors.lastName) { %>
                    <div class= "error-msg" id="error-lastName-msg">
                        <%= errors.lastName.msg %>               
                    </div>
                <% } %>
            </div>
            <div class="form-group">
                <i class="fa-solid fa-envelope"></i> 
                <input type="email" id="email" name="email" placeholder=""
                class="<%= locals.errors && errors.name 
                ? 'is-invalid' 
                : null 
                %>" value="<%= locals.oldData ? oldData.email : null %>">
                 <label for="email">Correo Electrónico</label>
                 <div class="error-message" id="error-email"></div>
                 <% if (locals.errors && errors.email) { %>
                    <div class= "error-msg" id="error-email-msg">
                        <%= errors.email.msg %>               
                    </div>
                <% } %>
            </div>
            <div class="form-group">
                <i class="fa-solid fa-key"></i> 
                <input type="password" id="password" name="password" placeholder=""
                class="">
                <label for="password">Contraseña</label>
                <div class="error-message" id="error-password"></div> 
                <% if (locals.errors && errors.password) { %>
                    <div class="error-msg" id="error-password-msg">
                        <%= errors.password.msg %>               
                    </div>
                <% } %>
              
            </div>
            <div class="form-group">
                <i class="fa-solid fa-key"></i> 
               
                <input type="password" id="confirm-password" name="confirmPassword" placeholder=""> 
                <label for="confirm-password">Confirmar Contraseña</label>
                <div class="error-message" id="error-confirm-password"></div>
            </div>
            <div class="form-group">
               
                <input type="file" id="profileImage" name="profileImage" id="profileImage" placeholder="" accept=".jpg, .jpeg, .png, .gif"
                class="<%= locals.errors && errors.name 
                ? 'is-invalid' 
                : null 
                %>" value="<%= locals.oldData ? oldData.profileImage : null %>">
                <label for="profileImage">Imagen de Perfil</label>
                <div class="error-message" id="error-profileImage"></div>
                <% if (locals.errors && errors.profileImage) { %>
                    <div class= "error-msg">
                        <%= errors.profileImage.msg %>               
                    </div>
                <% } %> 
            </div>
            <button class="form-button" type="submit">Registrar   
                <i class="fa-solid fa-thumbs-up"></i>
            </button>
        </form>
    </div>
     
  <%- include('./partials/footer') %>

  <script>
    window.onload = function() {
      
        const successMessage = document.getElementById('success-message');
        if (successMessage) {
            setTimeout(function() {
                successMessage.style.display = 'none';
            }, 5000); // 5000 milisegundos = 5 segundos
        }

        const fields = [
        { errorId: 'error-user-msg', inputId: 'username' },
        { errorId: 'error-firstName-msg', inputId: 'firstName' },
        { errorId: 'error-lastName-msg', inputId: 'lastName' },
        { errorId: 'error-email-msg', inputId: 'email' },
        { errorId: 'error-password-msg', inputId: 'password' }
       
    ];

    fields.forEach(field => {
        const errorElement = document.getElementById(field.errorId);
        const inputElement = document.getElementById(field.inputId);

        if (errorElement) {
            setTimeout(function() {
                errorElement.style.display = 'none';  
                inputElement.style.backgroundColor = 'white';
            }, 5000); // 5000 milisegundos = 5 segundos
        }
    });
    };
    
    
    

    
</script>
  <script src="/js/registroValidacion.js"></script> 
</body>

</html>
